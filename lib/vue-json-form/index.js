import e from"vue";import{Message as t}from"element-ui";var i={URL:/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/};let a={};a.object=e=>"[object object]"===Object.prototype.toString.call(e).toLowerCase(),a.url=e=>i.URL.test(e),a.string=e=>"string"==typeof e,a.array=e=>Array.isArray(e),a.function=e=>"function"==typeof e,a.prod=()=>{let e=window.location.origin;return!("prod"!==$ENV.env&&!e.includes(".zhizhi.info"))},a.json=e=>{if(a.string(e))try{return JSON.parse(e),!0}catch(e){return!1}return!1},a.buyer=()=>{let e=sessionStorage.getItem("USER_BASEINFO"),t=JSON.parse(e||"{}");return a.empty(t)||1===t.userRole},a.empty=function(e){return Array.isArray(e)?0===e.length||e.every((e=>a.empty(e))):a.object(e)?0===Object.keys(e).length:"number"==typeof e&&!isFinite(e)||(void 0===e||""===e||null===e)};var r={__proto__:null,getQuery:function(e){let t={};if(e&&-1!==e.indexOf("?")){let i=e.substring(e.indexOf("?")+1).split("&");for(let e=0;e<i.length;e++){let a=i[e].split("=");t[a[0]]=decodeURIComponent(a[1])}}return t},toQuery:function(e={}){let t=[];for(let i in e)if(e.hasOwnProperty(i)){let a=encodeURIComponent(e[i]||"");t.push(i+"="+a)}return t.length?"?"+t.join("&"):""}};function n(e,t=300,i){let a;return function(){let r=this,n=arguments;clearTimeout(a),a=setTimeout((function(){a=null,i||e.apply(r,n)}),t||0),i&&!a&&e.apply(r,n)}}function l(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return`${e()}${e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}var o={__proto__:null,debounce:n,deepClone:function e(t){if("object"!=typeof t)return;let i=t instanceof Array?[]:{};for(let a in t)"object"==typeof t[a]?i[a]=e(t[a]):i[a]=t[a];return i},getElementTop:function(e){let t=e.offsetTop,i=e.offsetParent;for(;null!==i;)t+=i.offsetTop,i=i.offsetParent;return t},getPureFormData:function(e){for(let t in e)a.empty(e[t])||t.includes(".")?delete e[t]:a.object(e[t])&&this.getPureFormData(e[t]);return e},guid:l,throttle:function(e,t=300){let i=null;return function(){const a=this,r=arguments;i||(i=setTimeout((function(){e.apply(a,r),i=null}),t))}},toFormData:function(e){let t=new FormData;for(let i in e)t.append(i,e[i]);return t}};var s={__proto__:null,canvasToFile:async function(e){return new Promise(((t,i)=>{e.toBlob((function(e){t(e)}))}))},getFileExt:function(e){return e.substring(e.lastIndexOf("."))},getImageSizeBySrc:function(e){return new Promise(((t,i)=>{let a=document.createElement("img");a.src=e,a.onload=function(){let e={width:this.width,height:this.height};t(e)},a.onerror=function(){i(new Error("load error"))}}))}};const d=Object.assign(o,r,s);e.use({install(e){e.prototype.$$is=a,e.prototype.$$utils=d,e.prototype.$$log=(...e)=>{console.log(...JSON.parse(JSON.stringify(e)))}}});let c={},u={bind(e,t,i){i.componentInstance.$on("click",(async a=>{a.stopPropagation(),e.disabled=!0;let r=e.getAttribute("vid");if(!r)return void console.error("提交按钮vid属性必填");let n=i.context.$el.querySelector(`div[vid="${r}"]`),l=await f(n),o=[c[n.dataset.uuid]],{form:s,list:d}=o[0],u=JSON.parse(JSON.stringify(s));m(u,d);let h=t.value.call(i.context,l,{formInstance:o,formData:u});h instanceof Promise?h.finally((()=>{e.disabled=!1})):console.error("v-onsubmit指令必须返回Promise")}))}};function m(e,t=[]){for(let i of t){if(i.field&&i.field.includes(".")){if(delete e[i.field],!i.key&&!i._vif){let t=i.field.split(".");delete e[t[0]][t[1]]}}else i.key||i._vif||!i.field||delete e[i.field];let t=i.list||i.formList;if(!a.empty(t)){let r=i.deepData?e[i.field]:e;if(!r||!a.object(r))break;if(i._vif)m(r,t);else for(let e of t)delete r[e.field],(e.list||e.formList)&&m(r,e.list||e.formList)}}for(let t in e)a.empty(e[t])&&delete e[t]}async function f(e){let t=[c[e.dataset.uuid]],i=[...e.querySelectorAll(".form-validator")];a.empty(i)||i.forEach((e=>{let i=e.dataset.uuid;t.push(c[i])})),t=t.reverse();let r=!0;for(let e of t.entries()){let t=e[1];await t.valid()||(r=!1)}return r}function h(e){return void 0===e||""===e||null===e}function p(e){return"string"==typeof e?e.trim():e}let g={};function v(e,t,i){if(g[e])console.error("Rule already exists");else if(t instanceof RegExp){let a=e=>!!h(e)||t.test(e);g[e]=[a,i]}else g[e]=[t,i]}function y(e){if(g[e])return g[e]}v("mobile",/^1\d{10}$/,"{{name}}格式不正确"),v("num",/^\d+$/,"{{name}}格式必须为>=0的整数"),v("integer",/^[1-9]\d*$/,"{{name}}为>0的整数"),v("char",/^[a-zA-Z]+$/,"{{name}}由英文字母组成"),v("nchar",/^[a-zA-Z0-9]+$/,"{{name}}由英文字母和数字组成"),v("version",/^([1-9]{1,3}|0)\.\d{1,3}\.\d{1,3}$/,"{{name}}格式不正确"),v("color",/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,"{{name}}格式不正确"),v("money",/(^-?[1-9](\d+)?(\.\d{1,2})?$)|(^-?0$)|(^-?\d\.\d{1,2}$)/,"{{name}}格式不正确"),v("email",/^[\w.\-]+@(?:[A-Za-z0-9]+(?:-[A-Za-z0-9]+)*\.)+[A-Za-z]{2,6}$/,"{{name}}格式不正确"),v("url",/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,"{{name}}格式不正确"),v("pathname",/^[a-z]+((\-)*[a-z0-9]+)*$/,"{{name}}必须以字母开头且由小写字母、数字、中划线组成"),v("required",(e=>!a.empty(p(e))),"{{name}}不能为空"),v("max",((e,t)=>!!h(e)||Number(e)<=Number(t)),"{{name}}必须小于等于{{max}}"),v("min",((e,t)=>!!h(e)||Number(e)>=Number(t)),"{{name}}必须大于等于{{min}}"),v("minlen",((e,t)=>!!h(e)||p(e).length>=Number(p(t))),"{{name}}的长度必须大于等于{{minlen}}"),v("maxlen",((e,t)=>!!h(e)||p(e).length<=Number(p(t))),"{{name}}的长度必须小于等于{{maxlen}}"),v("regexp",((e,t)=>!!h(e)||new RegExp(t,"g").test(p(e))),"{{name}}不符合规则"),v("password",((e,t)=>!t||!(e.length<8||e.length>16||/^\d+$/.test(e)||/^[A-Za-z]+$/.test(e)||/^[^A-Za-z0-9]+$/.test(e))),"密码长度8-16位，数字、字母、字符至少包含两种");const b=[".form-valid-failure-redborder",".el-textarea > textarea",".el-date-editor--daterange",".zx-datetimerange","input"];function x(e,t,i,a,r,n,l,o,s,d){"boolean"!=typeof l&&(s=o,o=l,l=!1);const c="function"==typeof i?i.options:i;let u;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),a&&(c._scopeId=a),n?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=u):t&&(u=l?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),u)if(c.functional){const e=c.render;c.render=function(t,i){return u.call(i),e(t,i)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,u):[u]}return i}const w=x({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"form-validator",attrs:{"data-uuid":e.uuid,vid:e.vid}},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"zxValidator",props:{form:{type:Object,default:()=>({})},list:{type:Array,default:()=>[]},vid:{type:String}},data:()=>({required:!1,validfnName:"valid",formName:"zxForm"}),computed:{uuid:()=>l()},created(){this.onChangeItemValue=n(this.onChangeItemValueFn,0)},mounted(){c[this.uuid]=this,this.vid&&this.$watch("form",(()=>this.onChangeItemValue()),{deep:!0})},methods:{onChangeItemValueFn(){this.$eventBus.$emit(this.uuid+this.vid,this.form)},getValidConfigList(e,t){let i=[];for(let a of e){let e=t.find((e=>e.field===a&&e._vif));i.push(e)}return i},getVisibleList(e){let t=[];for(let e of this.list)e._vif&&e.field&&t.push(e);return a.empty(e)?t:this.getValidConfigList(e,t)},async valid(e,t=!1){let i=this.getVisibleList(e),a="";for(let e=0;e<i.length;e++){let r=i[e],n=this.sortRules(r);for(let e of n.entries()){let i=e[1],n=y(i)||i===this.validfnName;if(n&&!1!==r.rules[i]){let{matched:e,message:l}=await this.matchRule(r,n,i,t);if(!e){a=l,this.showErrorTips(r.$el,a);break}this.showErrorTips(r.$el,"")}}}let r=""===a;return t?{matched:r,message:a}:r},sortRules(e){let t=e.rules||{},i=Object.keys(t),a=[];return this.addRuleName(a,i,"required"),this.addRuleName(a,i,"num"),this.addRuleName(a,i,"money"),i.forEach((e=>{"valid"!==e&&a.push(e)})),this.addRuleName(a,i,"valid"),a},addRuleName(e,t,i){t.forEach(((a,r)=>{a===i&&(t.splice(r,1),e.push(i))}))},showErrorTips(e,t){if(!e)return;let i=e.querySelector(".error-tips");if(!i)return;i.innerText=t;let a=t?"red":"";this.setInputBorderColor(e,a)},setInputBorderColor(e,t=""){for(let i of b){let a=e.querySelector(i);if(a){a.style["border-color"]=t;break}}},async matchRule(e,t,i,a=!1){let{field:r,rules:n,label:l}=e,o=this.form[r];if(!a&&e&&e.validResult)return e.validResult;let s={matched:!0,message:""};if(i.toLowerCase()!==this.validfnName){s.matched=t[0](o,n[i])||!1;let e=n[i];return s.message=this.getMessage(i,e,l)||"",s}let d=e.rules&&e.rules.valid;if(d){let t={};try{t=await d.call(this,{formData:this.form,rules:n,value:o,ctx:this.getContext(),config:e})}catch(e){return e}return s.matched=t.matched,s.message=t.message,s}},getMessage(e,t,i){var a;return(g[a=e]?g[a][1]:"").replace("{{name}}",i).replace(`{{${e}}}`,t)},getContext(){let e=this.$vnode.context;return e.$options.name===this.formName&&e.$vnode.context||e}},beforeDestroy(){delete c[this.uuid]}},undefined,false,undefined,!1,void 0,void 0,void 0);function _(e,t,i){let a=t.split("."),r=e;for(;a.length-1;){let e=a.shift();e in r||(r[e]={}),r=r[e]}r[a[0]]=i}var $={name:"prefixSuffix",inject:["getFormVm"],props:{formData:{type:Object},item:{type:Object},rowIndex:{type:Number},content:{type:[String,Array]}},methods:{onClick(e,t){if(e.click){let i=this.getFormVm();e.click({config:this.item,$form:i,e:t,ctx:this.getContext(),findItem:i.findItem,formData:i.formData,rowIndex:this.rowIndex})}},getContext(){return this.getFormVm().$vnode.context}}};const k="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function C(e){return(e,t)=>function(e,t){const i=k?t.media||"default":e,a=D[i]||(D[i]={ids:new Set,styles:[]});if(!a.ids.has(e)){a.ids.add(e);let i=t.source;if(t.map&&(i+="\n/*# sourceURL="+t.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),a.element||(a.element=document.createElement("style"),a.element.type="text/css",t.media&&a.element.setAttribute("media",t.media),void 0===z&&(z=document.head||document.getElementsByTagName("head")[0]),z.appendChild(a.element)),"styleSheet"in a.element)a.styles.push(i),a.element.styleSheet.cssText=a.styles.filter(Boolean).join("\n");else{const e=a.ids.size-1,t=document.createTextNode(i),r=a.element.childNodes;r[e]&&a.element.removeChild(r[e]),r.length?a.element.insertBefore(t,r[e]):a.element.appendChild(t)}}}(e,t)}let z;const D={};const A=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"wrapper",staticClass:"vue-json-form",class:e.className},[e.list.length?i("zx-validator",{ref:"validator",attrs:{vid:e.vid,form:e.formData,list:e.list}},[i("el-form",e._b({class:[e.$attrs.cols?"form-cols-"+e.$attrs.cols:""]},"el-form",e.$attrs,!1),[e._l(e.list,(function(t){return[t._vif?i("el-form-item",{key:t.key||t.field||t.label,class:[!1===t.showLabel?"form-label-hidden":"",t.rules&&!0===t.rules.required?"":"el-form-item-not-required"].concat(t.className||[],[t.list&&t.list.length?"form-list":""],[e.$attrs.inline?"":"form-item-block"]),attrs:{label:t.label,"form-field":t.field,required:t.rules&&t.rules.required||!1}},["formList"===t.type?i("vue-json-form",e._b({staticClass:"form-list-row",style:t.attrs&&t.attrs.style,attrs:{rowIndex:e.rowIndex,editable:e.editable,trigger:"change","label-position":"left",inline:!0,list:t.list},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},"vue-json-form",e.$attrs,!1)):e._e(),e._v(" "),"add-minus"===t.type?i("zx-add-minus",e._b({attrs:{item:t,editable:e.editable},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}},"zx-add-minus",t.attrs||{},!1)):i("div",{class:{"prefix-suffix-item":t.prefix||t.suffix}},[t.prefix?i("prefix-suffix",{staticClass:"prefix",attrs:{rowIndex:e.rowIndex,item:t,formData:e.formData,content:t.prefix}}):e._e(),e._v(" "),i("zx-form-item",{attrs:{editable:void 0!==t.editable?t.editable:e.editable,item:t,rowIndex:e.rowIndex,formData:e.formData},on:{change:e.onChangeItemValue},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}}),e._v(" "),t.suffix?i("prefix-suffix",{staticClass:"suffix",attrs:{rowIndex:e.rowIndex,formData:e.formData,item:t,content:t.suffix}}):e._e()],1)],1):e._e()]})),e._v(" "),e._t("default")],2)],1):e._e()],1)},staticRenderFns:[]},(function(e){e&&e("data-v-46c2ff56_0",{source:'.vue-json-form .el-form-item{margin-bottom:20px!important;text-align:left;vertical-align:middle}.vue-json-form .el-form-item .el-form-item .el-form-item__content{margin-left:0!important}.vue-json-form .form-list-inline-wrapper{display:flex;flex-direction:row;flex-wrap:wrap}.vue-json-form .form-list-inline-wrapper>.form-list-inline-item{margin-right:10px;display:flex;flex-direction:row;align-items:center}.vue-json-form .form-list-inline-wrapper>.form-list-inline-item:last-child{margin-right:0}.vue-json-form .el-form-item.form-list{margin-bottom:0!important}.vue-json-form .el-form-item.form-list .el-radio-group{margin-top:8px}.form-label-hidden>.el-form-item__label{display:none!important;margin-left:0}.form-label-hidden .el-form-item__content{margin-left:0!important;line-height:1.4!important}.el-form-item-not-required>.el-form-item__label:before{display:none!important}.prefix{padding-right:5px;box-sizing:border-box;display:flex;align-items:center}.suffix{padding-left:5px;box-sizing:border-box;display:flex;align-items:center}.prefix-suffix-item{display:flex}.form-item-text{text-align:left}.el-form-item>.el-form-item__label:before{content:"";display:inline-block;margin-right:4px;line-height:1;font-family:SimSun;font-size:12px}.form-cols-2.el-form--inline{display:table}.form-cols-2.el-form--inline .el-form-item{width:50%;margin-right:0}.form-cols-2.el-form--inline .vue-json-form-item>div{width:100%}.form-cols-3.el-form--inline{display:table}.form-cols-3.el-form--inline .el-form-item{width:33.33%;margin-right:0}.form-cols-3.el-form--inline .vue-json-form-item>div{width:100%}.form-cols-4.el-form--inline{display:table}.form-cols-4.el-form--inline .el-form-item{width:25%;margin-right:0}.form-cols-4.el-form--inline .vue-json-form-item>div{width:100%}.form-cols-5.el-form--inline{display:table}.form-cols-5.el-form--inline .el-form-item{width:20%;margin-right:0}.form-cols-5.el-form--inline .vue-json-form-item>div{width:100%}',map:void 0,media:void 0})}),{name:"VueJsonForm",components:{prefixSuffix:x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.content?i("div",["string"==typeof e.content?i("span",{domProps:{innerHTML:e._s(e.content)}}):Array.isArray(e.content)?i("span",[e._l(e.content,(function(t){return[!1!==t._vif?["button"===t.type?i("el-button",e._b({key:t.key,on:{click:function(i){return e.onClick(t,i)}}},"el-button",t.attrs||{},!1),[e._v("\n            "+e._s(e.formData[t.field]||t.label)+"\n          ")]):e._e(),e._v(" "),"icon"===t.type&&t.tooltip?i("el-tooltip",{key:t.key,attrs:{transfer:"",content:t.tooltip}},[i("el-icon",e._b({on:{click:function(i){return e.onClick(t,i)}}},"el-icon",t.attrs||{},!1))],1):"icon"===t.type?i("el-icon",e._b({key:t.key,on:{click:function(i){return e.onClick(t,i)}}},"el-icon",t.attrs||{},!1)):"image"===t.type?i("img",e._b({key:t.key,on:{click:function(i){return e.onClick(t,i)}}},"img",t.attrs||{},!1)):"a"===t.type?i("a",e._b({key:t.key},"a",t.attrs||{},!1),[e._v("\n            "+e._s(e.formData[t.field]||t.label)+"\n          ")]):"text"===t.type?i("label",e._b({key:t.key,domProps:{innerHTML:e._s(e.formData[t.field]||t.label)}},"label",t.attrs||{},!1)):e._e()]:e._e()]}))],2):e._e()]):e._e()])},staticRenderFns:[]},(function(e){e&&e("data-v-8a81a7c2_0",{source:".prefix-suffix-item{display:flex;flex-direction:row;width:100%}",map:void 0,media:void 0})}),$,undefined,false,undefined,!1,C,void 0,void 0)},props:{vid:{type:String},value:{type:Object,default:()=>({})},list:{type:Array,required:!0,default:()=>[]},className:{type:Array,default:()=>[]},trigger:{type:String},destroyClearData:{type:Boolean},rowIndex:{type:Number},editable:{type:Boolean,default:!0}},data:()=>({formData:{},initFormData:{},data:{},leafItems:[]}),provide(){return{getFormVm:()=>this}},created(){this.onChangeItemValue=n(this.onChangeItemValueFn,0),this.init()},mounted(){},methods:{init(){this.formData=this.value,this.showFormItem(),this.initFormData=JSON.parse(JSON.stringify(this.formData)),this.setFormData()},setFormData(){for(let e of this.list)this.setValueItem(e)},setValueItem(e){if(!e.field)return;let t=["checkbox-group","add-minus"];if(e.field&&e.field.includes(".")){let t=function(e,t){let i=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),a=e;for(;i.length;){let e=i.shift();if(!(e in a))return;a=a[e]}return a}(this.value,e.field);this.$set(this.formData,e.field,t)}else if(this.formData.hasOwnProperty(e.field)){if(e.field){let i=this.formData[e.field];t.includes(e.type)&&this.$$is.empty(i)&&(this.formData[e.field]=[])}}else{let i;e.hasOwnProperty("defaultValue")&&(i=e.defaultValue),t.includes(e.type)&&this.$$is.empty(i)&&(i=[]),this.$set(this.formData,e.field,i)}},showFormItem(e){e=e||this.list;for(let t of e)t.vif?this.$set(t,"_vif",t.vif(this.formData)):this.$set(t,"_vif",!0),t.list&&this.showFormItem(t.list),Array.isArray(t.suffix)&&this.showFormItem(t.suffix)},initUploadCompWidth(){let e=this.$refs.wrapper,t=e.querySelectorAll(".zx-image-upload"),i=e.querySelectorAll(".zx-file-upload");t=[...t].concat([...i]);let a=e.clientWidth,r=this.$attrs["label-width"]||"0px";r=Number(r.replace("px","")),t.forEach((e=>{e.offsetParent&&(e.offsetParent.style.width=a-r+"px")}))},async valid(e=[],t=!1){let i=this.$refs.validator;if(i&&i.$el){if(e.length){let a=await i.valid(e,t);return t?{matched:a.matched,message:a.message}:!0===a}return await f(i.$el)}},findItem(e){for(let t of this.list)if(e===t.field&&!1!==t._vif)return t},setPathValue(){for(let e in this.formData)e.includes(".")&&_(this.formData,e,this.formData[e])},getInitFormData(){return this.initFormData},resetFields(e={}){for(let e of this.leafItems)e.validResult&&(e.validResult=void 0);this.formData=e,this.valid()},onChangeItemValueFn(){this.setPathValue(),this.showFormItem(),this.setFormData()}},watch:{value:{handler(){this.formData=this.value,this.onChangeItemValue()}},list:{handler(){this.onChangeItemValue()}}}},undefined,false,undefined,!1,C,void 0,void 0);var S=new class{async uploadFile(e){if(window.uploadFile){return await window.uploadFile(e)}return{path:"https://esys-1254463895.cos.ap-shanghai.myqcloud.com/biz/2023/04/27/6993ad27447d02285c4b800ade982ec1.jpeg",poster:""}}},F="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},I="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,O=function(e){try{return!!e()}catch(e){return!0}},R=!O((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),j=function(e){return e&&e.Math==Math&&e},T=j("object"==typeof globalThis&&globalThis)||j("object"==typeof window&&window)||j("object"==typeof self&&self)||j("object"==typeof F&&F)||Function("return this")(),N=function(e){return"object"==typeof e?null!==e:"function"==typeof e},U={}.hasOwnProperty,E=function(e,t){return U.call(e,t)},P={exports:{}},V={},L=N,B=T.document,M=L(B)&&L(B.createElement),q=function(e){return M?B.createElement(e):{}},H=!R&&!O((function(){return 7!=Object.defineProperty(q("div"),"a",{get:function(){return 7}}).a})),J=N,W=function(e){if(!J(e))throw TypeError(String(e)+" is not an object");return e},Y=N,Z=R,K=H,G=W,Q=function(e,t){if(!Y(e))return e;var i,a;if(t&&"function"==typeof(i=e.toString)&&!Y(a=i.call(e)))return a;if("function"==typeof(i=e.valueOf)&&!Y(a=i.call(e)))return a;if(!t&&"function"==typeof(i=e.toString)&&!Y(a=i.call(e)))return a;throw TypeError("Can't convert object to primitive value")},X=Object.defineProperty;V.f=Z?X:function(e,t,i){if(G(e),t=Q(t,!0),G(i),K)try{return X(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(e[t]=i.value),e};var ee=V,te=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},ie=R?function(e,t,i){return ee.f(e,t,te(1,i))}:function(e,t,i){return e[t]=i,e},ae=T,re=ie,ne=function(e,t){try{re(ae,e,t)}catch(i){ae[e]=t}return t},le=ne,oe="__core-js_shared__",se=T[oe]||le(oe,{}),de=se;(P.exports=function(e,t){return de[e]||(de[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"});var ce=P.exports,ue=0,me=Math.random(),fe=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++ue+me).toString(36)},he=O,pe=!!Object.getOwnPropertySymbols&&!he((function(){return!String(Symbol())})),ge=pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ve=T,ye=E,be=fe,xe=pe,we=ge,_e=ce("wks"),$e=ve.Symbol,ke=we?$e:$e&&$e.withoutSetter||be,Ce=function(e){return ye(_e,e)||(xe&&ye($e,e)?_e[e]=$e[e]:_e[e]=ke("Symbol."+e)),_e[e]},ze={};ze[Ce("toStringTag")]="z";var De="[object z]"===String(ze),Ae={}.toString,Se=De,Fe=function(e){return Ae.call(e).slice(8,-1)},Ie=Ce("toStringTag"),Oe="Arguments"==Fe(function(){return arguments}()),Re=Se?Fe:function(e){var t,i,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Ie))?i:Oe?Fe(t):"Object"==(a=Fe(t))&&"function"==typeof t.callee?"Arguments":a},je={exports:{}},Te=se,Ne=Function.toString;"function"!=typeof Te.inspectSource&&(Te.inspectSource=function(e){return Ne.call(e)});var Ue,Ee,Pe,Ve=Te.inspectSource,Le=Ve,Be=T.WeakMap,Me="function"==typeof Be&&/native code/.test(Le(Be)),qe=fe,He=ce("keys"),Je=function(e){return He[e]||(He[e]=qe(e))},We=Me,Ye=N,Ze=ie,Ke=E,Ge=Je,Qe=T.WeakMap;if(We){var Xe=new Qe,et=Xe.get,tt=Xe.has,it=Xe.set;Ue=function(e,t){return it.call(Xe,e,t),t},Ee=function(e){return et.call(Xe,e)||{}},Pe=function(e){return tt.call(Xe,e)}}else{var at=Ge("state");Ue=function(e,t){return Ze(e,at,t),t},Ee=function(e){return Ke(e,at)?e[at]:{}},Pe=function(e){return Ke(e,at)}}var rt={set:Ue,get:Ee,has:Pe,enforce:function(e){return Pe(e)?Ee(e):Ue(e,{})},getterFor:function(e){return function(t){var i;if(!Ye(t)||(i=Ee(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return i}}},nt=T,lt=ie,ot=E,st=ne,dt=Ve,ct=rt.get,ut=rt.enforce,mt=String(String).split("String");(je.exports=function(e,t,i,a){var r=!!a&&!!a.unsafe,n=!!a&&!!a.enumerable,l=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||ot(i,"name")||lt(i,"name",t),ut(i).source=mt.join("string"==typeof t?t:"")),e!==nt?(r?!l&&e[t]&&(n=!0):delete e[t],n?e[t]=i:lt(e,t,i)):n?e[t]=i:st(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&ct(this).source||dt(this)}));var ft,ht=je.exports,pt=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},gt=function(e){return Object(pt(e))},vt=!O((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),yt=E,bt=gt,xt=vt,wt=Je("IE_PROTO"),_t=Object.prototype,$t=xt?Object.getPrototypeOf:function(e){return e=bt(e),yt(e,wt)?e[wt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?_t:null},kt=N,Ct=W,zt=function(e){if(!kt(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e},Dt=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),t=i instanceof Array}catch(e){}return function(i,a){return Ct(i),zt(a),t?e.call(i,a):i.__proto__=a,i}}():void 0),At=I,St=R,Ft=T,It=N,Ot=E,Rt=Re,jt=ie,Tt=ht,Nt=V.f,Ut=$t,Et=Dt,Pt=Ce,Vt=fe,Lt=Ft.Int8Array,Bt=Lt&&Lt.prototype,Mt=Ft.Uint8ClampedArray,qt=Mt&&Mt.prototype,Ht=Lt&&Ut(Lt),Jt=Bt&&Ut(Bt),Wt=Object.prototype,Yt=Wt.isPrototypeOf,Zt=Pt("toStringTag"),Kt=Vt("TYPED_ARRAY_TAG"),Gt=At&&!!Et&&"Opera"!==Rt(Ft.opera),Qt=!1,Xt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ei=function(e){return It(e)&&Ot(Xt,Rt(e))};for(ft in Xt)Ft[ft]||(Gt=!1);if((!Gt||"function"!=typeof Ht||Ht===Function.prototype)&&(Ht=function(){throw TypeError("Incorrect invocation")},Gt))for(ft in Xt)Ft[ft]&&Et(Ft[ft],Ht);if((!Gt||!Jt||Jt===Wt)&&(Jt=Ht.prototype,Gt))for(ft in Xt)Ft[ft]&&Et(Ft[ft].prototype,Jt);if(Gt&&Ut(qt)!==Jt&&Et(qt,Jt),St&&!Ot(Jt,Zt))for(ft in Qt=!0,Nt(Jt,Zt,{get:function(){return It(this)?this[Kt]:void 0}}),Xt)Ft[ft]&&jt(Ft[ft],Kt,ft);var ti={NATIVE_ARRAY_BUFFER_VIEWS:Gt,TYPED_ARRAY_TAG:Qt&&Kt,aTypedArray:function(e){if(ei(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(Et){if(Yt.call(Ht,e))return e}else for(var t in Xt)if(Ot(Xt,ft)){var i=Ft[t];if(i&&(e===i||Yt.call(i,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,i){if(St){if(i)for(var a in Xt){var r=Ft[a];r&&Ot(r.prototype,e)&&delete r.prototype[e]}Jt[e]&&!i||Tt(Jt,e,i?t:Gt&&Bt[e]||t)}},exportTypedArrayStaticMethod:function(e,t,i){var a,r;if(St){if(Et){if(i)for(a in Xt)(r=Ft[a])&&Ot(r,e)&&delete r[e];if(Ht[e]&&!i)return;try{return Tt(Ht,e,i?t:Gt&&Lt[e]||t)}catch(e){}}for(a in Xt)!(r=Ft[a])||r[e]&&!i||Tt(r,e,t)}},isView:function(e){var t=Rt(e);return"DataView"===t||Ot(Xt,t)},isTypedArray:ei,TypedArray:Ht,TypedArrayPrototype:Jt},ii=Math.ceil,ai=Math.floor,ri=function(e){return isNaN(e=+e)?0:(e>0?ai:ii)(e)},ni=ri,li=Math.min,oi=ri,si=function(e){var t=oi(e);if(t<0)throw RangeError("The argument can't be less than 0");return t},di=function(e){return e>0?li(ni(e),9007199254740991):0},ci=function(e,t){var i=si(e);if(i%t)throw RangeError("Wrong offset");return i},ui=gt,mi=ti.aTypedArray;(0,ti.exportTypedArrayMethod)("set",(function(e){mi(this);var t=ci(arguments.length>1?arguments[1]:void 0,1),i=this.length,a=ui(e),r=di(a.length),n=0;if(r+t>i)throw RangeError("Wrong length");for(;n<r;)this[t+n]=a[n++]}),O((function(){new Int8Array(1).set({})})));class fi{changeFileToBaseURL(e,t){let i=new FileReader;if(void 0===e)return t(null);i.readAsDataURL(e),i.onload=function(){let e=this.result;t(e)}}dataURLtoFile(e,t){let i=e.split(","),a=i[0].match(/:(.*?);/)[1],r=atob(i[1]),n=r.length,l=new Uint8Array(n);for(;n--;)l[n]=r.charCodeAt(n);return new File([l],t,{type:a})}compressImage(e){if(e&&e.success){if(void 0===e.file)return e.success(null);e.targetSize=e.hasOwnProperty("targetSize")?e.targetSize:-1,e.width=e.hasOwnProperty("width")?e.width:-1,e.fileName=e.hasOwnProperty("fileName")?e.fileName:"image",e.quality=e.hasOwnProperty("quality")?e.quality:.92;let t=this,i=e.file.type;if(-1===i.indexOf("image"))return console.log("请选择图片文件"),e.success(null);let a=e.file.size;if(e.targetSize>a)return e.success(e.file);this.changeFileToBaseURL(e.file,(function(a){if(a){let r=new Image;r.src=a,r.onload=function(){let a=this.width/this.height,n=document.createElement("canvas"),l=n.getContext("2d");n.width=-1===e.width?this.width:e.width,n.height=-1===e.width?this.height:parseInt(e.width/a),l.drawImage(r,0,0,n.width,n.height);let o=n.toDataURL(i,e.quality),s=t.dataURLtoFile(o,e.fileName);-1!==e.targetSize&&e.targetSize<s.size?(console.log("图片上传尺寸太大，请重新上传^_^"),e.success(null)):e.success(s)}}}))}}}function hi(e={}){(new fi).compressImage(e)}var pi={name:"zxImageUpload",props:{value:{type:[String,Array]},beforeUpload:{type:Function},successUpload:{type:Function},scale:{type:[Number,Array]},maxSize:{type:Number,default:5120},width:{type:Number},height:{type:Number},format:{type:Array,default:()=>[".png",".jpg",".jpeg"]},tips:{type:String},multiple:{type:Boolean,default:!1},readonly:{type:Boolean},multipleMax:{type:Number},type:{type:Number,default:0},buttonText:{type:String,default:"点击上传"},showPreview:{type:Boolean,default:!0},urlQueryAddSrouceName:{type:Boolean,default:!1},viewType:{type:String,default:"input"},imageWidth:{type:String,default:"50px"},imageHeight:{type:String,default:"50px"},footprint:{type:Boolean,default:!1}},data:()=>({reqCount:0,imageUrl:void 0,supportExtensions:/.png|.jpg|.jpeg/gi,selectedIndex:void 0,successArr:[],accept:void 0}),watch:{value:{handler(){if(this.multiple)return this.imageUrl=a.empty(this.value)?"":this.value[0],this.successArr=this.value||[],void(this.selectedIndex=0);this.imageUrl=this.value},immediate:!0}},created(){this.accept=this.format.map((e=>`image/${e.replace(".","")}`)).join(",")},mounted(){this.multiple?(this.imageUrl=a.empty(this.value)?"":this.value[0],this.successArr=this.value||[],this.selectedIndex=0):this.imageUrl=this.value},methods:{handleClick(){if(this.reqCount=0,this.multipleMax&&this.successArr.length>=this.multipleMax)return void t.error("最多只能上传"+this.multipleMax+"张图片");this.$refs.file.click();let e=this;this.$refs.file.onchange=async function(){let i=0,a=[];if(e.multipleMax){if(e.successArr.length+this.files.length>e.multipleMax)return void t.error("最多只能上传"+e.multipleMax+"张图片")}for(let t of this.files){let r=t.name;t.size/1024>500&&hi({file:t,fileName:r,quality:.6,success(e){e&&(t=e,console.log(t.size/1024,"kb"))}});let n,l=r.substring(r.lastIndexOf("."));r=r.replace(l,"");try{n=await e.getImageSize(t)}catch(e){console.log(e),n={}}let{width:o,height:s}=n;if(!e.valid(t,o,s,l))return void(e.$refs.file.value="");a.push({fileName:r,file:t,extensions:l,height:s,width:o,useType:5}),i++}if(i===this.files.length)for(const[t,i]of a.entries()){let r=await e.upload({file:i.file}),n=r.path;if(!n&&e.multiple)return e.$emit("change",e.successArr),void(e.imageUrl||(e.imageUrl=e.successArr[0]));e.urlQueryAddSrouceName&&(n=n+"?sourceName="+i.fileName),e.multiple?(e.successArr.push(n),t===a.length-1&&(e.$emit("change",e.successArr),e.$emit("input",e.successArr),e.imageUrl||(e.imageUrl=e.successArr[0]))):(e.imageUrl=n,e.$emit("change",n),e.$emit("input",n)),e.$emit("success",r),e.successUpload&&e.successUpload(r)}}},handleInputBlur(){if(this.multiple)return this.$emit("input",this.value),void this.$emit("change",this.value);this.$emit("input",this.imageUrl),this.$emit("change",this.imageUrl)},async upload(e){let t="";try{t=await S.uploadFile({file:e.file,type:this.type,footprint:this.footprint}),this.$refs.file.value=""}catch(e){console.log(e),this.$refs.file.value=""}return t},valid(e,i,a,r){let n=!0;if(this.beforeUpload)n=this.beforeUpload.call(this.$vnode.context,e);else{if(this.format.indexOf(r.toLowerCase())<0)return t.error("不支持该图片类型！"),!1;if(e.size/1024>this.maxSize)return this.maxSize/1024>=1?t.error(`上传图片大小不能超过${this.maxSize/1024}MB!`):t.error(`上传图片大小不能超过${this.maxSize}KB!`),!1;if(this.width&&i!==this.width)return t.error(`图片宽必须为${this.width}px!`),!1;if(this.height&&a!==this.height)return t.error(`图片高必须为${this.height}px!`),!1;const n=i/a;if(Array.isArray(this.scale)){if(this.scale&&!this.scale.includes(n))return t.error("图片宽高比例不正确"),!1}else if(this.scale&&n!==this.scale)return t.error("图片宽高比例不正确"),!1}return n},getImageSize(e){return new Promise(((t,i)=>{let a={},r=new FileReader;r.onload=e=>{var r=e.target.result,n=new Image;n.onload=()=>{a.width=n.width,a.height=n.height,t(a)},n.onerror=()=>{this.$refs.file.value="",i(new Error("图片加载失败"))},n.src=r},r.readAsDataURL(e)}))},onClickPreview(e,t){this.selectedIndex=t,this.imageUrl=e},onDelete(e,t){this.successArr.splice(t,1),this.$emit("input",this.successArr),this.imageUrl===e&&(this.imageUrl=void 0)},getReadonly(){return!(!this.multiple&&!a.prod())},onChange(){this.imageUrl!==this.value&&(this.$emit("change",this.imageUrl),this.$emit("input",this.imageUrl))},onImageError(e){if(this.reqCount++,this.reqCount<10){let t=e.target.src,i="";i=t.includes("?")?"&_t=":"?_t=";let a=setTimeout((()=>{e.target.src=t+i+1e3*Math.random(),clearTimeout(a)}),500)}}}};const gi=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"zx-image-upload"},[i("input",{ref:"file",staticClass:"hidden",attrs:{accept:e.accept,type:"file",multiple:e.multiple}}),e._v(" "),"input"===e.viewType||e.multiple?i("div",{staticClass:"upload-type-input"},[i("div",[i("el-popover",{staticClass:"icon-preview",attrs:{placement:"top-start",width:"400",trigger:"hover"}},[i("div",[i("img",{staticStyle:{width:"400px"},attrs:{src:e.imageUrl},on:{error:function(t){return e.onImageError(t)}}})]),e._v(" "),i("span",{attrs:{slot:"reference"},slot:"reference"},[e.imageUrl?i("img",{staticClass:"p-r-5",staticStyle:{width:"30px",height:"30px","object-fit":"contain"},attrs:{src:e.imageUrl},on:{error:function(t){return e.onImageError(t)}}}):i("img",{staticClass:"p-r-5",staticStyle:{width:"30px",height:"30px","object-fit":"contain"}})])]),e._v(" "),i("el-input",{staticClass:"full-width m-r-5",attrs:{readonly:e.getReadonly(),disabled:e.$attrs.disabled,clearable:!e.multiple,placeholder:e.$attrs.placeholder||"请上传图片"},on:{blur:e.handleInputBlur,change:e.onChange},model:{value:e.imageUrl,callback:function(t){e.imageUrl="string"==typeof t?t.trim():t},expression:"imageUrl"}}),e._v(" "),i("el-button",{attrs:{disabled:e.$attrs.disabled,icon:"ios-cloud-upload-outline"},on:{click:e.handleClick}},[e._v("\n        "+e._s(e.buttonText)+"\n      ")])],1),e._v(" "),e.tips?i("div",{staticClass:"tips f12 t3"},[i("p",[i("span",[e._v(e._s(e.tips))])])]):e._e(),e._v(" "),e.multiple&&e.successArr.length&&e.showPreview?i("div",{staticClass:"multiple-preview"},e._l(e.successArr,(function(t,a){return i("div",{key:a,class:{selected:e.selectedIndex===a},on:{click:function(i){return e.onClickPreview(t,a)}}},[i("img",{attrs:{src:t},on:{error:function(t){return e.onImageError(t)}}}),e._v(" "),i("div",{staticClass:"delete",on:{click:function(i){return i.stopPropagation(),e.onDelete(t,a)}}},[e._v("删除")])])})),0):e._e()]):"thumbnail"!==e.viewType||e.multiple?e._e():i("div",{staticClass:"border-1",style:{width:e.imageWidth,height:e.imageHeight}},[e.imageUrl?i("el-popover",{staticClass:"icon-preview",staticStyle:{margin:"0 auto"},attrs:{placement:"bottom",width:"300",trigger:"hover"}},[i("span",[i("img",{staticStyle:{width:"300px",height:"300px","object-fit":"contain"},attrs:{src:e.imageUrl}})]),e._v(" "),i("span",{attrs:{slot:"reference"},slot:"reference"},[i("span",{staticClass:"pointer full-width full-height text-center"},[i("img",{staticStyle:{width:"100%",height:"100%","object-fit":"contain"},attrs:{src:e.imageUrl},on:{click:e.handleClick}})])])]):e._e(),e._v(" "),e.imageUrl?e._e():i("span",{staticClass:"icon flex-row flex-center pointer",on:{click:e.handleClick}},[i("i",{staticClass:"el-icon-plus t3"})])],1)])},staticRenderFns:[]},(function(e){e&&e("data-v-5fa18398_0",{source:".zx-image-upload{line-height:1.4}.zx-image-upload .upload-type-input>div{display:flex;flex-direction:row}.zx-image-upload .tips{padding-top:6px;font-size:12px;color:#909399}.zx-image-upload .multiple-preview{width:100%;font-size:12px;border:1px solid #dcdee2;border-radius:4px;margin-top:5px;flex-wrap:wrap}.zx-image-upload .multiple-preview>div{position:relative;border:1px solid #fff;margin:5px}.zx-image-upload .multiple-preview .selected{border:1px solid #ed143d}.zx-image-upload .multiple-preview img{width:100px;height:100px;object-fit:contain}.zx-image-upload .multiple-preview .delete{cursor:pointer;position:absolute;bottom:0;left:0;width:100px;text-align:center;background-color:#ed143d;height:20px;line-height:20px;color:#fff;font-size:12px}.zx-image-upload a.preview{color:#2d8cf0}.zx-image-upload .icon{background-color:#f7f8fa;cursor:pointer;box-sizing:border-box;flex:0 0 100%}.zx-image-upload .el-icon-plus{font-size:40px}",map:void 0,media:void 0})}),pi,undefined,false,undefined,!1,C,void 0,void 0);var vi={name:"zxFileUpload",props:{value:{type:String},type:{type:Number,default:3},beforeUpload:{type:Function},successUpload:{type:Function},maxSize:{type:Number,default:10240},format:{type:Array,default:()=>[".mp4"]},readonly:{type:Boolean},tips:{type:String},buttonText:{type:String,default:"点击上传"},uploadType:{type:Number,default:1},upload:{type:Function},showInput:{type:Boolean,default:!0}},data:()=>({fileUrl:void 0}),watch:{value:{handler(){this.fileUrl=this.value},immediate:!0}},methods:{handleClick(){this.$refs.file.click();let e=this;this.$refs.file.onchange=async function(){let t=this.files[0],i=t.name,a=i.substring(i.lastIndexOf("."));if(!e.valid(t,a))return void(e.$refs.file.value="");let r={fileName:i,file:t,extensions:a,type:e.type};try{if(2===e.uploadType)return e.upload&&e.upload(r),e.$emit("input",i),void(e.$refs.file.value="");let t=await S.uploadFile({file:r.file,type:e.type}),a=t.path;a&&(e.fileUrl=a,e.$emit("input",a),e.$emit("change",a),e.$emit("success",t),e.successUpload&&e.successUpload(t)),e.$refs.file.value=""}catch(t){e.$refs.file.value=""}}},valid(e,i){if(".ZIP"===i)return t.error("zip格式必后缀必须小写！"),!1;if(this.format.indexOf(i.toLowerCase())<0)return t.error("不支持该文件类型！"),!1;return e.size/1024>this.maxSize?(this.maxSize/1024>=1?t.error(`上传文件大小不能超过${this.maxSize/1024}MB!`):t.error(`上传文件大小不能超过${this.maxSize}KB!`),!1):!this.beforeUpload||this.beforeUpload.call(this.$vnode.context,e)},isVideo:e=>[".mp4",".avi",".wmv"].includes(e),getReadonly(){return void 0!==this.readonly?this.readonly:!!a.prod()},onChange(){this.fileUrl!==this.value&&(this.$emit("change",this.fileUrl),this.$emit("input",this.fileUrl))}}};const yi=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"zx-file-upload"},[i("div",[e.showInput?i("el-input",{staticClass:"full-width",attrs:{readonly:e.getReadonly(),disabled:e.$attrs.disabled,clearable:!0,placeholder:e.$attrs.placeholder||"请上传文件"},on:{change:e.onChange},model:{value:e.fileUrl,callback:function(t){e.fileUrl="string"==typeof t?t.trim():t},expression:"fileUrl"}}):e._e(),e._v(" "),i("input",{ref:"file",staticClass:"hidden",attrs:{type:"file"}}),e._v(" "),i("el-button",{staticClass:"m-l-5",attrs:{disabled:e.$attrs.disabled,icon:"ios-cloud-upload-outline"},on:{click:e.handleClick}},[e._v("\n      "+e._s(e.buttonText)+"\n    ")])],1),e._v(" "),e.tips?i("p",{staticClass:"m-t-5 t3 f12"},[e._v(e._s(e.tips))]):e._e(),e._v(" "),i("div",{ref:"videobox"})])},staticRenderFns:[]},(function(e){e&&e("data-v-74737f36_0",{source:".zx-file-upload{line-height:1.4}.zx-file-upload>div{display:flex;flex-direction:row}.zx-file-upload .tips{padding-top:6px}",map:void 0,media:void 0})}),vi,undefined,false,undefined,!1,C,void 0,void 0);const bi=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"zx-select-remote",class:{"focus-abled":e.focusInput},on:{click:function(t){return t.stopPropagation(),e.onClickWrapper(t)}}},[i("div",{staticClass:"form-valid-failure-redborder"},[e.multiple?e._e():i("el-input",e._b({ref:"input",attrs:{clearable:e.$attrs.clearable},on:{focus:e.onFocus,clear:e.onClearKeyword,input:e.remoteSearch},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},"el-input",e.$attrs,!1)),e._v(" "),e.multiple?i("div",[i("div",{staticClass:"tags-wrap"},[e._l(e.selectedOptions,(function(t,a){return i("div",{key:a,staticClass:"tag-selected",class:{"full-width":e.fullWidth},on:{click:function(e){e.stopPropagation()},dblclick:function(i){return i.stopPropagation(),e.onRemoveTag(t)}}},[i("span",[e._v(e._s(t[e.labelField]))]),e._v(" "),i("i",{staticClass:"el-icon-close f14 pointer",on:{click:function(i){return i.stopPropagation(),e.onRemoveTag(t)}}})])})),e._v(" "),i("el-input",{ref:"input",class:{"input-auto":!e.fullWidth},attrs:{clearable:!1,placeholder:e.$attrs.placeholder},on:{focus:e.onFocus,input:e.remoteSearch},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],2)]):e._e(),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.multiple&&e.showDropdown||!e.multiple&&e.keyword&&e.showDropdown,expression:"\n        (multiple && showDropdown) || (!multiple && keyword && showDropdown)\n      "}],staticClass:"dropdown-options-wrap",on:{click:function(e){e.stopPropagation()}}},[i("div",{staticClass:"dropdown-options"},[e._l(e.dropdownOptions,(function(t,a){return i("div",{key:a,staticClass:"option",class:{"option-selected":t.selected},on:{click:function(i){return i.stopPropagation(),e.onChange(t)}}},[e._v("\n          "+e._s(t[e.labelField])+"\n        ")])})),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.dropdownOptions.length,expression:"!dropdownOptions.length"}],staticClass:"nodata"},[i("span",[e._v("暂无数据")])])],2)])],1)])},staticRenderFns:[]},(function(e){e&&e("data-v-6d2fed04_0",{source:".zx-select-remote{font-size:12px;line-height:1.2;position:relative;box-sizing:border-box;user-select:none}.zx-select-remote>div{background-color:#fff;border:1px solid #dcdee2;border-radius:3px}.zx-select-remote .el-input-medium{height:30px}.zx-select-remote .tags-wrap{padding:0 5px;background-color:#fff}.zx-select-remote .tags-wrap .tag-selected{width:auto;display:inline-block;padding:5px;border:1px solid #e8eaec;border-radius:3px;background:#f7f7f7;overflow:hidden;margin:3px 0 0;margin-right:5px}.zx-select-remote .tags-wrap .full-width{width:100%;margin-right:0;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.zx-select-remote .tags-wrap .full-width:first-child{margin-bottom:0;margin-top:3px}.zx-select-remote .tags-wrap .full-width:last-child{margin-bottom:0}.zx-select-remote .el-input{border:0;outline:0}.zx-select-remote .el-input .el-input__inner{border:0;padding:0 5px;text-indent:10px}.zx-select-remote .el-input:focus{border:0;box-shadow:none}.zx-select-remote .input-auto{width:98px;display:inline-block;position:relative;vertical-align:top;line-height:normal}.zx-select-remote .dropdown-options-wrap{width:100%}.zx-select-remote .dropdown-options-wrap .dropdown-options{position:absolute;max-width:calc(100% + 100px);min-width:100%;top:calc(100% + 2px);z-index:999;background-color:#fff;border:1px solid #dcdee2;max-height:200px;min-height:100px;overflow-y:auto;overflow-x:hidden;white-space:nowrap}.zx-select-remote .dropdown-options-wrap .dropdown-options .option-selected{color:rgba(45,140,240,.9)}.zx-select-remote .dropdown-options-wrap .dropdown-options .option{cursor:pointer;padding:5px;padding-left:10px}.zx-select-remote .dropdown-options-wrap .dropdown-options .option:hover{background-color:#f3f3f3}.zx-select-remote .dropdown-options-wrap .nodata{display:flex;align-items:center;justify-content:center;height:40px;color:rgba(45,140,240,.9)}",map:void 0,media:void 0})}),{name:"zxSelectRemote",props:{valueField:{type:String,default:"id"},labelField:{type:String,default:"name"},value:{type:[String,Number,Array]},label:{type:String},fullWidth:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},searchField:{type:String,default:"q"},getData:{type:Function},getLabel:{type:Function},getSelectedOptions:{type:Function},initSearch:{type:Boolean,default:!1}},inject:["getFormVm"],data:()=>({loading:!1,showDropdown:!1,keyword:void 0,focusInput:!1,data:[],dropdownOptions:[],selectedOptions:[]}),watch:{value:{handler(){this.data=this.value,a.empty(this.value)&&(this.dropdownOptions=[],this.selectedOptions=[],this.keyword=void 0)},immediate:!0}},created(){let e=this.getFormVm();if(this.getSelectedOptions){this.selectedOptions=this.getSelectedOptions(e.formData,e);let t=this.selectedOptions.map((e=>e[this.valueField]));this.$emit("input",t)}else this.getLabel?this.keyword=this.getLabel(e.formData,e):this.label&&(this.keyword=this.label);this.getSelectedOptions||this.init()},mounted(){document.addEventListener("click",this.clickBodyHandler)},methods:{async init(){if(this.multiple)this.initMultipleData(this.data);else{let e={};if(e[this.valueField]=this.value,this.initSearch){if(!a.empty(this.value)){let t=this.value,i={};i[this.valueField]=t;let a=await this.getData(i,{$form:this.getFormVm(),isInit:!0});this.keyword=a&&a[0]&&a[0][this.labelField]||"",e[this.labelField]=this.keyword,this.$emit("input",t)}}else e[this.labelField]=this.label;e.selected=!0,this.selectedOptions=[e]}},remoteSearch:n((async function(e){this.showDropdown=!0,this.focusInput=!0,this.queryByKey(e)}),300),async initMultipleData(e=[]){let t=e.join(",");if(!t)return;let i={};i[this.searchField]=t,this.initQueryById(i)},async initQueryById(e){let t=await this.getData(e,this.getFormVm());a.empty(t)?this.dropdownOptions=[]:(t.forEach((e=>e.selected=!0)),this.selectedOptions=t)},async queryByKey(e){if(!e)return;let t={};t[this.searchField]=e;let i=await this.getData(t,this.getFormVm());a.empty(i)?this.dropdownOptions=[]:(i.forEach(((e,t)=>{e.selected=!1;let a=this.selectedOptions.find((t=>t[this.valueField]===e[this.valueField]));a&&a[this.valueField]&&(e.selected=!0,i.splice(t,1,a))})),this.dropdownOptions=i)},onChange(e){if(this.multiple){if(e.selected)return void this.onRemoveTag(e);e.selected=!0,this.selectedOptions.push(e);let t=this.selectedOptions.map((e=>e[this.valueField]));this.$emit("input",t),this.$emit("change",t),this.keyword="",this.showDropdown=!0}else this.dropdownOptions.forEach((e=>{e.selected=!1})),e.selected=!0,this.selectedOptions=[e],this.$emit("input",e[this.valueField]),this.keyword=e[this.labelField],this.showDropdown=!1,this.$emit("change",e[this.valueField])},onRemoveTag(e){e.selected=!1,this.selectedOptions=this.selectedOptions.filter((t=>t[this.valueField]!==e[this.valueField]));let t=this.selectedOptions.map((e=>e[this.valueField]));this.$emit("input",t),this.keyword="",this.$emit("change",t)},onFocus(){this.showDropdown=!0,this.focusInput=!0,!this.multiple&&a.empty(this.dropdownOptions)&&this.queryByKey(this.keyword)},onClickWrapper(){this.$refs.input.focus()},onClearKeyword(e,t,i){this.selectedOptions=[],this.$emit("input",void 0),this.$emit("change",void 0),this.showDropdown=!1},clickBodyHandler(e){"INPUT"!==e.target.tagName&&"BODY"!==e.target.tagName?(this.keyword||this.multiple?this.keyword&&this.multiple&&(this.keyword=""):(this.selectedOptions=[],this.$emit("input",void 0)),this.showDropdown=!1,this.focusInput=!1):(this.focusInput=!1,this.showDropdown=!1)},getContext(){let e=this.getFormVm();return e.$vnode.context||e}},beforeDestroy(){document.removeEventListener("click",this.clickBodyHandler)}},undefined,false,undefined,!1,C,void 0,void 0);var xi={name:"zxFormItem",props:{item:{type:Object},value:{},formData:{type:Object},rowIndex:{type:Number},editable:{type:Boolean,default:!0}},inject:["getFormVm"],data:()=>({RANGE_TYPES:["datetimerange","daterange","timerange"],data:void 0,clearable:!0}),watch:{value:{handler(e,t){e!==t&&(this.data=this.value,this.changeHandler(),this.item.hasOwnProperty("validResult")&&(this.item.validResult=void 0))},deep:!0},data(e,t){e!==t&&this.data!==this.value&&this.$emit("input",e)}},created(){this.data=this.value,this.clearable=this.getClearAble(),this.$nextTick((()=>{this.getConfig()}))},mounted(){this.item.$el=this.$refs.formItem;let e=this.getRootUVid();e&&this.$eventBus.$on(e,(e=>{let t=this.getParam();t.globalFormData=e,this.item.valueChange&&this.item.valueChange(t)}))},methods:{getRootUVid(){let e,t=this.$parent;for(;t;){if(t.$props&&t.$props.vid){e=t,t=null;break}t=t.$parent}if(e&&e.$props&&e.$props.vid){let t=e.$props.vid;return e.$el.getAttribute("data-uuid")+t}},getClearAble(){return!this.item.attrs||!1!==this.item.attrs.clearable},async getConfig(){let e=this.getParam();if(a.function(this.item.optionsAsync)){let t=await this.item.optionsAsync(e);this.$set(this.item,"options",t)}if(a.function(this.item.dataAsync)){let t=await this.item.dataAsync(e);this.$set(this.item,"data",t)}if(a.function(this.item.textAsync)){let t=await this.item.textAsync(e);this.$set(this.item,"text",t)}this.changeHandler()},getDateAttrs({rules:e={},attrs:t={}},i){let a=Object.assign({},e,t);return a.placeholder=(a.placeholder||"请选择")+this.item.label,a["range-separator"]=a["range-separator"]||"至",a["value-format"]=a["value-format"]||i,a.valid&&(a.valid=""),a},getAttrs({rules:e={},attrs:t={}},i="请选择"){let a=Object.assign({},e,t);return a.valid&&(a.valid=""),e&&e.required&&!1!==this.item.deepData&&(a.validator=this.item.label),a.placeholder=a.placeholder||i+this.item.label,a},onChange(e){let t=this.isEmpty(e)?"":e;this.setPathValue(t),this.changeHandler(t)},setPathValue(e){this.item.field.includes(".")&&_(this.formData,this.item.field,e)},changeHandler(e){let t=this.getFormVm();if(this.$emit("input",this.data),this.$emit("change",this.data),a.function(this.item.change)){if(this.$set(this.item,"value",this.data),this.t)return;this.t=setTimeout((async()=>{let t=await this.item.change(this.getParam(e));this.t=null,this.isEmpty(e)||this.handleResult(t)}))}else if(this.validTrigger("change")&&!this.item.blur&&!1!==this.item.change||!0===this.item.change){if(this.isEmpty(e))return;this.$nextTick((async()=>{let e=await t.valid([this.item.field],!0);this.item.validResult=e}))}},isEmpty(e){return null==e||!(!Array.isArray(e)||!this.RANGE_TYPES.includes(this.item.type))&&e.every((e=>this.isEmpty(e)))},validTrigger(e){let t=this.getFormVm();if(t.$attrs&&t.trigger===e)return!0},async onBlur(e){let t=this.getFormVm();if(this.$emit("input",this.data),a.function(this.item.blur)){if(this.$set(this.item,"value",this.data),a.function(this.item.blur)){let t=this.item.blur(this.getParam(e));this.handleResult(t)}}else(this.validTrigger("blur")||!0===this.item.blur)&&this.$nextTick((async()=>{let e=await t.valid([this.item.field],!0);this.item.validResult=e}))},onFocus(e){a.function(this.item.focus)&&this.item.focus(this.getParam(e))},onClick(e){this.item.click&&this.item.click(this.getParam(e))},getParam(e){let t=this.getContext(),i=this.getFormVm();return{formData:i.formData,ctx:t,config:this.item,value:this.data,vm:this,$form:i,findItem:i.findItem,e,rowIndex:this.rowIndex}},async handleResult(e){let t,i=this.getFormVm();if(e instanceof Promise){!0===await e&&(t=await i.valid([this.item.field],!0))}else!0===e&&(t=await i.valid([this.item.field],!0));this.validTrigger("change")&&(t=await i.valid([this.item.field],!0)),this.item.validResult=t},getContext(){let e=this.getFormVm();return e.$vnode.context||e},getDisabled(){if(this.item.attrs){if(this.$$is.function(this.item.attrs.disabled)){return this.item.attrs.disabled(this.getParam())}return this.item.attrs.disabled}return!1}},computed:{displayLabel(){if(!this.editable){if(a.function(this.item.display))return this.item.display(this.getParam());if(a.object(this.item.mapList)){return this.item.mapList[this.value]}if(Array.isArray(this.item.mapList)){let{label:e}=this.item.mapList.find((e=>e.value===this.value))||{};return e}}}},beforeDestroy(){let e=this.getFormVm();(this.item.attrs&&this.item.attrs.destroyClearData||e.destroyClearData||e.$attrs.destroyClearData)&&(this.$emit("input",void 0),this.item.value=void 0),this.item.validResult&&(this.item.validResult=void 0)}};const wi=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"formItem",staticClass:"zx-form-item",style:e.item.attrs&&e.item.attrs.style},[!1===e.editable?i("div",{domProps:{innerHTML:e._s(e.displayLabel)}}):["input"===e.item.type?i("el-input",e._b({attrs:{validator:e.item.label,clearable:e.clearable,disabled:e.getDisabled(),field:e.item.field},on:{input:e.onChange,blur:e.onBlur},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-input",e.getAttrs(e.item,"请输入"),!1)):"textarea"===e.item.type?i("el-input",e._b({attrs:{validator:e.item.label,clearable:e.clearable,type:e.item.type,disabled:e.getDisabled(),field:e.item.field},on:{input:e.onChange,blur:e.onBlur},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-input",e.getAttrs(e.item,"请输入"),!1)):"input-number"===e.item.type?i("el-input-number",e._b({attrs:{validator:e.item.label,clearable:e.clearable,type:e.item.type,disabled:e.getDisabled(),field:e.item.field},on:{change:e.onChange,blur:e.onBlur},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-input-number",e.getAttrs(e.item),!1)):"rate"===e.item.type?i("el-rate",e._b({attrs:{validator:e.item.label,type:e.item.type,"allow-half":"",disabled:e.getDisabled(),field:e.item.field},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-rate",e.getAttrs(e.item),!1)):"text"===e.item.type?i("div",{staticClass:"form-item-text",class:e.item.rowClass,on:{click:e.onClick}},[e.data?i("div",{domProps:{innerHTML:e._s(e.data)}}):i("div",{domProps:{innerHTML:e._s(e.item.text)}})]):"button"===e.item.type?i("el-button",e._b({attrs:{disabled:e.getDisabled()},on:{click:e.onClick}},"el-button",e.getAttrs(e.item),!1),[e._v("\n      "+e._s(e.item.label)+"\n    ")]):"select"===e.item.type?i("el-select",e._b({attrs:{validator:e.item.label,clearable:e.clearable,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange,focus:e.onFocus},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-select",e.getAttrs(e.item),!1),e._l(e.item.options||[],(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,disabled:e.disabled||!1,value:e.value}})})),1):"cascader"===e.item.type&&e.item.options?i("el-cascader",e._b({attrs:{validator:e.item.label,field:e.item.field,options:e.item.options||[],clearable:e.clearable,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-cascader",e.getAttrs(e.item),!1)):"cascader"===e.item.type&&e.item.data?i("el-cascader",e._b({attrs:{validator:e.item.label,field:e.item.field,data:e.item.data||[],clearable:e.clearable,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-cascader",e.getAttrs(e.item),!1)):"radio"===e.item.type?i("el-radio-group",e._b({attrs:{validator:e.item.label,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-radio-group",e.getAttrs(e.item),!1),e._l(e.item.options||[],(function(t){return i("el-radio",{key:t.value,attrs:{disabled:t.disabled||!1,label:t.value}},[e._v("\n        "+e._s(t.label)+"\n      ")])})),1):"radio-button"===e.item.type?i("el-radio-group",e._b({attrs:{validator:e.item.label,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-radio-group",e.getAttrs(e.item),!1),e._l(e.item.options||[],(function(t){return i("el-radio-button",{key:t.value,attrs:{disabled:t.disabled||!1,label:t.value}},[e._v("\n        "+e._s(t.label)+"\n      ")])})),1):"checkbox-group"===e.item.type?i("el-checkbox-group",e._b({attrs:{validator:e.item.label,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-checkbox-group",e.getAttrs(e.item),!1),e._l(e.item.options||[],(function(t){return i("el-checkbox",{key:t.value,attrs:{label:t.value,disabled:t.disabled||!1}},[e._v("\n        "+e._s(t.label)+"\n      ")])})),1):"checkbox"===e.item.type?i("el-checkbox",e._b({attrs:{label:e.item.text||"",validator:e.item.label,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-checkbox",e.getAttrs(e.item),!1)):"select-search"===e.item.type?i("zx-select-remote",e._b({attrs:{validator:e.item.label,disabled:e.getDisabled(),field:e.item.field},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"zx-select-remote",e.getAttrs(e.item,"请输入"),!1)):"switch"===e.item.type?i("div",e._b({staticClass:"switch-items-wrap"},"div",{style:e.getAttrs(e.item).style||{}},!1),[i("el-switch",e._b({attrs:{validator:e.item.label,disabled:e.getDisabled(),field:e.item.field},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-switch",e.getAttrs(e.item),!1))],1):"color"===e.item.type?i("zx-color-picker",e._b({attrs:{validator:e.item.label,disabled:e.getDisabled(),field:e.item.field},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"zx-color-picker",e.getAttrs(e.item),!1)):"date"===e.item.type?i("el-date-picker",e._b({attrs:{validator:e.item.label,field:e.item.field,disabled:e.getDisabled(),type:e.item.type},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-date-picker",e.getDateAttrs(e.item,"yyyy-MM-dd"),!1)):"datetime"===e.item.type?i("el-date-picker",e._b({attrs:{validator:e.item.label,field:e.item.field,type:e.item.type,disabled:e.getDisabled(),"value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-date-picker",e.getDateAttrs(e.item,"yyyy-MM-dd HH:mm:ss"),!1)):"time"===e.item.type?i("el-time-picker",e._b({attrs:{validator:e.item.label,field:e.item.field,type:e.item.type,disabled:e.getDisabled(),"value-format":"HH:mm"},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-time-picker",e.getDateAttrs(e.item,"HH:mm"),!1)):e.RANGE_TYPES.includes(e.item.type)?i("zx-form-daterange",{attrs:{formData:e.formData,item:e.item,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}}):"imageUpload"===e.item.type?i("zx-image-upload",e._b({attrs:{validator:e.item.label,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"zx-image-upload",e.getAttrs(e.item),!1)):"fileUpload"===e.item.type?i("zx-file-upload",e._b({attrs:{validator:e.item.label,field:e.item.field,disabled:e.getDisabled()},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"zx-file-upload",e.getAttrs(e.item),!1)):e._e()],e._v(" "),e.item.list?e._e():i("p",{staticClass:"error-tips"})],2)},staticRenderFns:[]},(function(e){e&&e("data-v-6762f623_0",{source:".form-item-block .zx-form-item>div{width:100%}.zx-form-item{position:relative}.zx-form-item>div{width:200px}.zx-form-item .switch-items-wrap{width:60px}.zx-form-item .form-item-text{word-break:break-all;line-height:1.4;min-height:32px;display:flex;align-items:center;color:#606266}.zx-form-item .el-rate{margin-top:6px}.zx-form-item .el-e-cascader{display:block}.zx-form-item .error-tips{color:red;font-size:12px;position:absolute;top:110%;white-space:nowrap;line-height:100%}.el-form-inline .zx-image-upload button{margin-right:10px}",map:void 0,media:void 0})}),xi,undefined,false,undefined,!1,C,void 0,void 0);const _i=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"zx-add-minus"},e._l(e.addList,(function(t,a){return i("div",{key:t.$idx,staticClass:"zx-add-row",class:[e.divider?"row-divider":"no-row-divider",e.showAddIcon||e.showDelIcon?"has-icon":""]},[i("vue-json-form",e._b({ref:"addMinus",refInFor:!0,class:[e.inline?"add-minus-form-inline":"add-minus-form-block"],attrs:{inline:e.inline,editable:e.editable,trigger:e.trigger,rowIndex:a,list:t.list},model:{value:e.value[a],callback:function(t){e.$set(e.value,a,t)},expression:"value[index]"}},"vue-json-form",e.attrs,!1)),e._v(" "),0===a&&e.showAddIcon?i("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(t){return e._onAdd()}}}):e.showDelIcon?i("i",{staticClass:"el-icon-remove-outline",on:{click:function(t){return e._onDel(a)}}}):e._e()],1)})),0)},staticRenderFns:[]},(function(e){e&&e("data-v-77a6ed1c_0",{source:".zx-add-minus .add-minus-form-inline>.form-validator>form{display:flex;flex-wrap:wrap}.zx-add-minus .add-minus-form-inline>.form-validator>form .th-form-item{display:flex;flex-wrap:nowrap;margin-bottom:24px}.zx-add-minus .add-minus-form-block>.form-validator>form .th-form-item{display:flex;flex-wrap:nowrap;margin-bottom:24px}.zx-add-minus .el-icon-circle-plus-outline,.zx-add-minus .el-icon-remove-outline{color:#2d8cf0;font-size:22px;margin-top:-20px;cursor:pointer}.zx-add-minus .zx-add-row{display:flex;flex-direction:row;align-items:center;padding-top:20px}.zx-add-minus .zx-add-row .add-row-item{padding-bottom:20px}.zx-add-minus .zx-add-row.row-divider{border-bottom:1px dotted #d7d7d7}.zx-add-minus .zx-add-row:first-child{padding-top:0}.zx-add-minus .zx-add-row.no-row-divider{padding-top:0}.zx-add-minus .close-items-0{opacity:0}.zx-add-minus .m-t_20{margin-top:-20px}",map:void 0,media:void 0})}),{name:"zxAddMinus",props:{value:{type:Array,default:()=>[]},item:{type:Object},maxlength:{type:Number},inline:{type:Boolean,default:!0},divider:{type:Boolean,default:!0},editable:{type:Boolean,default:!0},showAddIcon:{type:Boolean,default:!0},showDelIcon:{type:Boolean,default:!0},trigger:{type:String},keepOne:{type:Boolean,default:!0},defaultRowData:{type:Object}},inject:["getFormVm"],data:()=>({maxIdx:0,addList:[],attrs:{}}),created(){let e=this.getFormVm();this.attrs=e.$attrs,this.init(),this.item.getInstance&&this.item.getInstance(this.getInstance(this))},methods:{init(){if(this.value.length){let e=[];this.value.forEach(((t,i)=>{t.$idx=i;let a=this.$$utils.deepClone(this.item.list);e.push({$idx:i,list:a})})),this.addList=e,this.maxIdx=this.value.length-1}else this.keepOne&&this.addNewRow()},addNewRow(){let e=this.getNewRowConfig(),t=this.getNewRowValue();this.addList.push(e),this.value.push(t)},getInstance(){return this},async _onAdd(e){if(this.maxlength&&this.addList.length>=this.maxlength)return void this.$message({message:`超过最大限制${this.maxlength}`,type:"warning"});let t=this.getNewRowConfig(),i=this.getNewRowValue(e);!1!==await this.rowChange("add",this.addList.length,t,i)&&(this.value.push(i),this.addList.push(t))},async _onDel(e){let t=0;t=this.$$is.object(e)?this.value.findIndex((t=>t.$idx===e.$idx)):e;let i=this.addList[t],a=this.value[t];!1!==await this.rowChange("delete",t,i,a)&&(this.addList.splice(t,1),this.value.splice(t,1))},addRow(e={}){this._onAdd(e)},delRow(e={}){this._onDel(e)},rowChange(e,t,i,a){let r=this.item.rowChange||this.$attrs.rowChange;if(r){return r({type:e,...this.getParams(t,i,a)})}},getParams(e,t,i){return{$forms:this.$refs.addMinus,index:e,values:this.value,targetValue:i,target:t,addList:this.addList,ctx:this.$vnode.context,formData:this.$vnode.context.formData}},getNewRowConfig(){let e=this.getMaxIdx(),t=this.$$utils.deepClone(this.item.list);for(let e of t)delete e.validResult,delete e.$el;return{$idx:e,list:t}},getNewRowValue(e){if(!this.$$is.empty(e))return JSON.parse(JSON.stringify(e));let t=this.defaultRowData?JSON.parse(JSON.stringify(this.defaultRowData)):{};return t.$idx=this.maxIdx,t},getMaxIdx(){return this.maxIdx+=1,this.maxIdx},delDiff(){if(this.$$is.empty(this.value)&&this.keepOne)return this.addList=[],void this.$nextTick((()=>{this.addNewRow()}));let e=[];this.addList.forEach((t=>{this.value.find((e=>e.$idx===t.$idx))||e.push(t.$idx)})),this.addList=this.addList.filter((t=>!e.includes(t.$idx)))}},watch:{value:{handler(){if(this.value.length>this.addList.length){let e=this.value.length,t=this.addList.length;for(let i=0;i<e-t;i++){let e=this.getNewRowConfig();this.addList.push(e)}}else this.value.length<this.addList.length&&this.delDiff()}}}},undefined,false,undefined,!1,C,void 0,void 0);const $i=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"zx-color-picker"},[i("el-color-picker",e._b({on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-color-picker",e.$attrs,!1)),e._v(" "),i("el-input",e._b({staticClass:"color-input",attrs:{clearable:""},on:{input:e.onChange,blur:e.onBlur},model:{value:e.data2,callback:function(t){e.data2=t},expression:"data2"}},"el-input",e.$attrs,!1))],1)},staticRenderFns:[]},(function(e){e&&e("data-v-4f097d9a_0",{source:".zx-color-picker{width:200px;display:flex;align-items:center}.zx-color-picker .color-input{flex-grow:1;margin-left:4px}.zx-color-picker .el-color-picker-rel{width:60px;min-width:60px}",map:void 0,media:void 0})}),{name:"zxColorPicker",props:{value:{type:String}},data:()=>({data:void 0,data2:void 0}),methods:{onChange(e){this.$emit("change",e)},onBlur(e){this.$emit("blur",e)}},watch:{value:{handler(){this.data=this.value,this.data2=this.value},immediate:!0},data(){this.data2=this.data,this.$emit("input",this.data)},data2(){this.data=this.data2,this.$emit("input",this.data)}}},undefined,false,undefined,!1,C,void 0,void 0);var ki={name:"zxFormDaterange",props:{value:{},item:{type:Object},formData:{type:Object}},inject:["getFormVm"],data:()=>({data:void 0,start:void 0,end:void 0}),created(){this.start=this.item.attrs.startField,this.end=this.item.attrs.endField;let e=[this.formData[this.start]||"",this.formData[this.end]||""];this.changeHandler(e)},methods:{getAttrs({rules:e={},attrs:t={}},i="请选择"){let a=Object.assign({},e,t);return a.valid&&(a.valid=""),e&&e.required&&!1!==this.item.deepData&&(a.validator=this.item.label),a.placeholder=a.placeholder||i+this.item.label,a},changeHandler(e){e=e||[],this.$set(this.formData,this.start,e[0]),this.$set(this.formData,this.end,e[1]),this.$emit("input",e),this.data=e},onChange(e){this.changeHandler(e),this.emitChange()},emitChange(){this.$emit("change",this.data)}},watch:{formData:{handler(e,t){let i=[this.formData[this.start]||"",this.formData[this.end]||""];this.data=this.data||["",""],i[0]===this.data[0]&&i[1]===this.data[1]||(this.data=i,this.$emit("input",this.data))},deep:!0}},beforeDestroy(){let e=this.getFormVm();(this.item.attrs&&this.item.attrs.destroyClearData||e.$attrs.destroyClearData)&&(this.$emit("input",void 0),this.$set(this.formData,this.start,void 0),this.$set(this.formData,this.end,void 0))}};const Ci=x({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return"daterange"===e.item.type?i("el-date-picker",e._b({attrs:{validator:e.item.label,field:e.item.field,type:e.item.type,"value-format":"yyyy-MM-dd"},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-date-picker",e.getAttrs(e.item),!1)):"datetimerange"===e.item.type?i("el-date-picker",e._b({staticClass:"zx-datetimerange",attrs:{validator:e.item.label,field:e.item.field,type:e.item.type,"value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-date-picker",e.getAttrs(e.item),!1)):"timerange"===e.item.type?i("el-time-picker",e._b({staticClass:"zx-datetimerange",attrs:{validator:e.item.label,field:e.item.field,type:e.item.type,"value-format":"HH:mm:ss"},on:{change:e.onChange},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"el-time-picker",e.getAttrs(e.item),!1)):e._e()},staticRenderFns:[]},(function(e){e&&e("data-v-1286b3b5_0",{source:".zx-form-item .el-date-picker{width:100%;min-width:200px}.zx-form-item .zx-datetimerange{min-width:200px}",map:void 0,media:void 0})}),ki,undefined,false,undefined,!1,C,void 0,void 0);e.component(w.name,w),e.component(A.name,A),e.component(gi.name,gi),e.component(yi.name,yi),e.component(bi.name,bi),e.component(wi.name,wi),e.component(_i.name,_i),e.component($i.name,$i),e.component(Ci.name,Ci),e.directive("onsubmit",u),e.use({install(e){e.prototype.$eventBus=new e}});
